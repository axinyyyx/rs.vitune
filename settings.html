<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ViTune Settings</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@400;500&family=Open+Sans:wght@400;600&family=Lato:wght@400;700&family=Montserrat:wght@400;600&family=Arial&family=Times+New+Roman" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-gray-900 text-white font-poppins transition-all duration-200 overflow-hidden">
    <!-- Navbar -->
    <nav class="fixed top-0 left-0 right-0 bg-gray-800 bg-opacity-80 backdrop-blur-md shadow-lg z-50">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <a onclick="history.back();" class="text-teal-500 hover:text-teal-300 accent-teal transition duration-200"><i class="fa fa-arrow-left text-lg"></i></a>
            <div class="flex items-center space-x-2">
                <img src="img/logo.png" alt="ViTune Logo" class="w-8 h-8 object-cover">
                <h1 class="text-xl font-bold">ViTune Settings</h1>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6 pb-24 fixed top-16 left-0 right-0 bottom-0 overflow-y-auto no-scrollbar">
        <div class="bg-gray-800 rounded-lg p-4 mb-4 setting-card transition-all duration-200">
            <h2 class="text-lg font-semibold mb-3">Appearance</h2>
            <div class="mb-3">
                <label class="block text-sm mb-1">Theme</label>
                <select id="theme-style" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="dark">Dark</option>
                    <option value="light-mode">Light</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Song Card Transparency</label>
                <select id="song-card-transparency" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="off">Off</option>
                    <option value="on">On</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Transparent Effect (Player)</label>
                <select id="transparent-effect" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="off">Off</option>
                    <option value="on">On</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Font Style</label>
                <select id="font-style" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="poppins">Poppins</option>
                    <option value="roboto">Roboto</option>
                    <option value="open-sans">Open Sans</option>
                    <option value="lato">Lato</option>
                    <option value="montserrat">Montserrat</option>
                    <option value="arial">Arial</option>
                    <option value="times">Times New Roman</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Font Size</label>
                <select id="font-size" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="xsmall">Extra Small</option>
                    <option value="small">Small</option>
                    <option value="medium">Medium</option>
                    <option value="large">Large</option>
                    <option value="xlarge">Extra Large</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Accent Color</label>
                <select id="accent-color" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="teal">Teal</option>
                    <option value="purple">Purple</option>
                    <option value="pink">Pink</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Animation Speed</label>
                <select id="animation-speed" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="fast">Fast</option>
                    <option value="normal">Normal</option>
                    <option value="slow">Slow</option>
                </select>
            </div>
        </div>

        <div class="bg-gray-800 rounded-lg p-4 mb-4 setting-card transition-all duration-200">
            <h2 class="text-lg font-semibold mb-3">Playback</h2>
            <div class="mb-3 flex items-center space-x-4">
                <label class="text-sm">Mood</label>
                <div class="mood-toggle">
                    <input type="checkbox" id="mood-filter" class="hidden" checked>
                    <label for="mood-filter" class="mood-toggle-label">
                        <span class="mood-toggle-inner"></span>
                        <span class="mood-toggle-switch"></span>
                    </label>
                </div>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Progress Bar Color</label>
                <select id="progress-bar-color" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="teal">Teal</option>
                    <option value="red">Red</option>
                    <option value="blue">Blue</option>
                    <option value="purple">Purple</option>
                    <option value="pink">Pink</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Progress Bar Style</label>
                <select id="progress-bar-style" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="simple">Simple</option>
                    <option value="gradient">Gradient</option>
                    <option value="wave">Wave</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="block text-sm mb-1">Bitrate</label>
                <select id="bitrate" class="w-full bg-gray-700 text-white rounded-lg py-1 px-2 text-sm transition duration-200 hover:bg-gray-600">
                    <option value="1">48kbps</option>
                    <option value="2">96kbps</option>
                    <option value="3">160kbps</option>
                    <option value="4">320kbps</option>
                </select>
            </div>
        </div>

        <div class="bg-gray-800 rounded-lg p-4 mb-4 setting-card transition-all duration-200">
            <h2 class="text-lg font-semibold mb-3">Data Backup</h2>
            <div class="flex space-x-4">
                <button id="export-data" class="bg-teal-500 text-white rounded-full py-2 px-4 hover:bg-teal-600 text-sm transition duration-200">Export Data</button>
                <button id="import-data" class="bg-teal-500 text-white rounded-full py-2 px-4 hover:bg-teal-600 text-sm transition duration-200">Import Data</button>
                <input type="file" id="file-input" accept=".json" class="hidden">
            </div>
        </div>

        <div class="bg-gray-800 rounded-lg p-4 mb-4 setting-card transition-all duration-200">
            <h2 class="text-lg font-semibold mb-3">Reset</h2>
            <div class="flex space-x-4">
                <button id="reset-settings" class="bg-red-500 text-white rounded-full py-2 px-4 hover:bg-red-600 text-sm transition duration-200">Reset Settings</button>
                <button id="reset-data" class="bg-red-500 text-white rounded-full py-2 px-4 hover:bg-red-600 text-sm transition duration-200">Reset Data</button>
            </div>
        </div>

        <div class="bg-gray-800 rounded-lg p-4 setting-card transition-all duration-200">
            <h2 class="text-lg font-semibold mb-3">About Developer</h2>
            <div class="flex items-center space-x-4">
                <img src="https://avatars.githubusercontent.com/u/164033987?v=4" alt="Rishabh Kumar" class="w-20 h-20 rounded-full object-cover shadow-md">
                <div>
                    <h3 class="text-lg font-bold text-teal-300">Rishabh Kumar</h3>
                    <p class="text-sm text-gray-400">Have ideas or suggestions? Reach out via social media or email!</p>
                    <div class="flex space-x-2 mt-1">
                        <a href="https://github.com/axinyyyx" target="_blank" class="text-teal-500 hover:text-teal-300 accent-teal"><i class="fa fa-github"></i></a>
                        <a href="https://www.instagram.com/rishabhsahill" target="_blank" class="text-teal-500 hover:text-teal-300 accent-teal"><i class="fa fa-instagram"></i></a>
                        <a href="https://x.com/rishabhsahill" target="_blank" class="text-teal-500 hover:text-teal-300 accent-teal"><i class="fa fa-twitter"></i></a>
                        <a href="https://www.facebook.com/rishabhsahill" target="_blank" class="text-teal-500 hover:text-teal-300 accent-teal"><i class="fa fa-facebook"></i></a>
                        <a href="mailto:githubsahil4@gmail.com" class="text-teal-500 hover:text-teal-300 accent-teal"><i class="fa fa-envelope"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="js/backup.js"></script>
    <script>
        $(document).ready(function() {
            const STORAGE_KEYS = { 
                SETTINGS: 'settings',
                HISTORY: 'listening_history',
                LIKES: 'likes',
                PLAYLISTS: 'playlists',
                OFFLINE: 'offlineSongs',
                PLAY_QUEUE: 'play_queue',
                CURRENT_SONG: 'current_song'
            };
            const defaultSettings = {
                theme: 'dark',
                songCardTransparency: 'off',
                transparentEffect: 'off',
                fontStyle: 'poppins',
                fontSize: 'medium',
                progressBarColor: 'teal',
                progressBarStyle: 'simple',
                bitrate: '4',
                moodFilter: 'on',
                accentColor: 'teal',
                animationSpeed: 'normal'
            };

            // Load settings
            const settings = { ...defaultSettings, ...JSON.parse(localStorage.getItem(STORAGE_KEYS.SETTINGS) || '{}') };
            $('#theme-style').val(settings.theme);
            $('#song-card-transparency').val(settings.songCardTransparency);
            $('#transparent-effect').val(settings.transparentEffect);
            $('#font-style').val(settings.fontStyle);
            $('#font-size').val(settings.fontSize);
            $('#progress-bar-color').val(settings.progressBarColor);
            $('#progress-bar-style').val(settings.progressBarStyle);
            $('#bitrate').val(settings.bitrate);
            $('#mood-filter').prop('checked', settings.moodFilter === 'on');
            $('#accent-color').val(settings.accentColor);
            $('#animation-speed').val(settings.animationSpeed);

            // Save settings on change
            $('select, #mood-filter').on('change', function() {
                const newSettings = {
                    theme: $('#theme-style').val(),
                    songCardTransparency: $('#song-card-transparency').val(),
                    transparentEffect: $('#transparent-effect').val(),
                    fontStyle: $('#font-style').val(),
                    fontSize: $('#font-size').val(),
                    progressBarColor: $('#progress-bar-color').val(),
                    progressBarStyle: $('#progress-bar-style').val(),
                    bitrate: $('#bitrate').val(),
                    moodFilter: $('#mood-filter').prop('checked') ? 'on' : 'off',
                    accentColor: $('#accent-color').val(),
                    animationSpeed: $('#animation-speed').val()
                };
                localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(newSettings));
                $(window).trigger('settings:updated');
            });

            // Reset settings
            $('#reset-settings').on('click', function() {
                if (confirm('Reset all settings to default? This will not affect playlists, likes, or other data.')) {
                    localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(defaultSettings));
                    $(window).trigger('settings:updated');
                    alert('Settings reset to default.');
                    location.reload();
                }
            });

            // Reset all data
            $('#reset-data').on('click', function() {
                if (confirm('Reset all data? This will clear settings, playlists, likes, recent plays, offline songs, play queue, and current song.')) {
                    localStorage.removeItem(STORAGE_KEYS.HISTORY);
                    localStorage.removeItem(STORAGE_KEYS.LIKES);
                    localStorage.removeItem(STORAGE_KEYS.PLAYLISTS);
                    localStorage.removeItem(STORAGE_KEYS.OFFLINE);
                    localStorage.removeItem(STORAGE_KEYS.PLAY_QUEUE);
                    localStorage.removeItem(STORAGE_KEYS.CURRENT_SONG);
                    localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(defaultSettings));
                    $(window).trigger('settings:updated');
                    alert('All data and settings reset.');
                    location.reload();
                }
            });

            // Backup and Restore
            $('#export-data').on('click', function() {
                exportData();
            });

            $('#import-data').on('click', function() {
                $('#file-input').click();
            });

            $('#file-input').on('change', function(event) {
                const file = event.target.files[0];
                if (file && file.name.endsWith('.json')) {
                    importData(file);
                } else {
                    alert('Please select a valid .json file.');
                }
                event.target.value = ''; // Reset file input
            });
        });
    </script>
</body>
</html>